i2s_audio:
  - id: audio_bus
    i2s_lrclk_pin: 
      number: GPIO45
      allow_other_uses: true
      ignore_strapping_warning: true
    i2s_bclk_pin: 
      number: GPIO17
      allow_other_uses: true
    i2s_mclk_pin: 
      number: GPIO02
      allow_other_uses: true
  - id: audio_bus_out
    i2s_lrclk_pin: 
      number: GPIO45
      allow_other_uses: true
      ignore_strapping_warning: true
    i2s_bclk_pin: 
      number: GPIO17
      allow_other_uses: true
    i2s_mclk_pin: 
      number: GPIO02
      allow_other_uses: true

audio_dac:
  - platform: es8311
    id: es8311_dac
    bits_per_sample: 16bit
    sample_rate: 16000
    i2c_id: audio_i2c

speaker:
  - platform: i2s_audio
    i2s_audio_id: audio_bus_out
    id: ${devicename}_speaker
    i2s_dout_pin: GPIO15
    dac_type: external
    sample_rate: 16000
    bits_per_sample: 16bit
    channel: mono
    audio_dac: es8311_dac
    timeout: 5s

media_player:
  - platform: nabu
    name: ${devicename}_media
    id: ${devicename}_media
    speaker:
    volume_increment: 0.05
    volume_min: 0.4
    volume_max: 0.85
    on_announcement:
      - nabu.set_ducking:
          decibel_reduction: 20
          duration: 0.0s
    on_idle:
    - micro_wake_word.stop:
    - delay: 2s
    - micro_wake_word.start:
    
audio_adc:
  - platform: es7210
    id: es7210_adc
    bits_per_sample: 16bit
    sample_rate: 16000
    i2c_id: audio_i2c


microphone:
  - platform: i2s_audio
    i2s_audio_id: audio_bus
    id: external_mic
    adc_type: external
    pdm: false
    i2s_din_pin: GPIO16
    bits_per_sample: 16bit
