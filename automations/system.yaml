- id: system_update_available
  alias: system_update_available
  initial_state: 'off'
  trigger:
    platform: state
    entity_id: updater.updater
  action:
    service: notify.brett_notify
    data:
      message: 'Update for Home Assistant is available.'
      
- id: letsencrypt-renewal
  alias: "letsencrypt-renewal"
  initial_state: 'off'
  trigger:
  - platform: time
    at: '03:00:00'
  action:
  - service: hassio.addon_restart
    data:
      addon: core_letsencrypt
    
- id: 'ha_start'
  alias: ha_start
  trigger:
  - event: start
    platform: homeassistant
  condition: []
  action:
  - data:
      entity_id: script.initialization
    service: script.turn_on
    
- id: 'house_sts_occupants'
  alias: house_sts_occupants
  initial_state: 'off'
  trigger:
  - entity_id: binary_sensor.house_sts_occupants
    platform: state
  condition: []
  action:
  - data:
      entity_id: script.hvac_run_setpoint
    service: script.turn_on
  - data_template:
      entity_id: >
           {% if is_state('binary_sensor.house_sts_occupants', 'off') and is_state('binary_sensor.house_sts_guest', 'off') %}
             scene.house_away
           {% else %}
             scene.house_home
           {% endif %} 
    service: scene.turn_on  
  - data_template:
      message: >
        Occupancy mode changed to {{ states('binary_sensor.house_sts_occupants') }}
    service: notify.gmail_notify
  - data:
      entity_id: alarm_control_panel.alarm_panel
      code: !secret alarmcode
    service_template: >
      {% if is_state('house_status', 'Away') %}
        alarm_control_panel.alarm_arm_away
      {% else %}
        alarm_control_panel.alarm_disarm
      {% endif %}
