homeassistant:
  customize:
  
light:
  - platform: mqtt
    name: 'garage_ext_1'
    state_topic: "hawirelesslink/light/ledvance_a19_rgbw_00060a5e_1/state" 
    command_topic: "/HAwirelesslink/return/light/ledvance_a19_rgbw_00060a5e_1/state"
    brightness_state_topic: "hawirelesslink/light/ledvance_a19_rgbw_00060a5e_1/brightness"
    brightness_command_topic: "/HAwirelesslink/return/light/ledvance_a19_rgbw_00060a5e_1/brightness"
    payload_on: "on"
    payload_off: "off"
    rgb_state_topic: "hawirelesslink/light/ledvance_a19_rgbw_00060a5e_1/rgb_color"
    rgb_value_template: "{{ value | replace('[','') | replace(']','') | trim }}"
    rgb_command_topic: "/HAwirelesslink/return/light/ledvance_a19_rgbw_00060a5e_1/rgb_color"
    rgb_command_template: "{{ '%02x%02x%02x' | format(red, green, blue)}}"
    optimistic: false

  - platform: mqtt
    name: 'garage_ext_2'
    state_topic: "hawirelesslink/light/ledvance_a19_rgbw_00061a28_1/state" 
    command_topic: "/HAwirelesslink/return/light/ledvance_a19_rgbw_00061a28_1/state"
    brightness_state_topic: "hawirelesslink/light/ledvance_a19_rgbw_00061a28_1/brightness"
    brightness_command_topic: "/HAwirelesslink/return/light/ledvance_a19_rgbw_00061a28_1/brightness"
    payload_on: "on"
    payload_off: "off"
    rgb_state_topic: "hawirelesslink/light/ledvance_a19_rgbw_00061a28_1/rgb_color"
    rgb_value_template: "{{ value | replace('[','') | replace(']','') | trim }}"
    rgb_command_topic: "/HAwirelesslink/return/light/ledvance_a19_rgbw_00061a28_1/rgb_color"
    rgb_command_template: "{{ '%02x%02x%02x' | format(red, green, blue)}}"
    optimistic: false
    
  - platform: mqtt
    name: 'porch_light'
    state_topic: "hawirelesslink/light/ledvance_a19_rgbw_0005ccab_1/state" 
    command_topic: "/HAwirelesslink/return/light/ledvance_a19_rgbw_0005ccab_1/state"
    brightness_state_topic: "hawirelesslink/light/ledvance_a19_rgbw_0005ccab_1/brightness"
    brightness_command_topic: "/HAwirelesslink/return/light/ledvance_a19_rgbw_0005ccab_1/brightness"
    payload_on: "on"
    payload_off: "off"
    rgb_state_topic: "hawirelesslink/light/ledvance_a19_rgbw_0005ccab_1/rgb_color"
    rgb_value_template: "{{ value | replace('[','') | replace(']','') | trim }}"
    rgb_command_topic: "/HAwirelesslink/return/light/ledvance_a19_rgbw_0005ccab_1/rgb_color"
    rgb_command_template: "{{ '%02x%02x%02x' | format(red, green, blue)}}"
    optimistic: false

binary_sensor:
  - platform: mqtt # Detect motion from fron camera from blueiris
    state_topic: "blueiris/frontyard"
    name: front_foscam_motion
    payload_on: "motion"
    payload_off: "clear"
    
  - name: doorbell_person
    platform: mqtt
    state_topic: "frigate/doorbell/person"
    device_class: motion
    availability_topic: "frigate/available"
    
camera:
  - platform: mjpeg
    name: frontdoor
    still_image_url: http://192.168.2.200:81/image/frontdoor?q=100&s=100
    mjpeg_url: http://192.168.2.200:81/mjpg/frontdoor/video.mjpg
    
  - platform: mjpeg
    name: "Front Porch"
    still_image_url: http://192.168.2.200:81/image/Frontyard?q=100&s=100
    mjpeg_url: http://192.168.2.200:81/mjpg/frontyard/video.mjpg
    
  - name: doorbell_last_person
    platform: mqtt
    topic: frigate/doorbell/person/snapshot
  - name: Doorbell Last Car
    platform: mqtt
    topic: frigate/doorbell/car/snapshot

automation:
  - alias: doorbell_person_detected
    trigger: 
      platform: state
      entity_id: binary_sensor.doorbell_person
      from: 'off'
      to: 'on'
    condition:
      - condition: state
        entity_id: lock.front_door
        state: locked
    action:
      - service: camera.snapshot
        data:
          entity_id: camera.doorbell_last_person
          filename: /config/www/snapshot1.jpg
      - delay: 5
      - service: notify.group_notify
        data:
          message: "Homie be up in your yard"
          data:
             attachment:
            url: "hhttps://homeassistant.teamcarriger.club/local/snapshot1.jpg"
            content-type: png
            hide-thumbnail: false
